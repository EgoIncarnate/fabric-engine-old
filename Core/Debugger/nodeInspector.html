<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">  
  <!--
    Copyright 2010-2011 Fabric Technologies Inc. All rights reserved.
    -->
  <title>FABRIC Node Inspector</title>
    
  <link type="text/css" href="../../ThirdParty/jQuery/css/fabric/jquery-ui-1.8.16.custom.css" rel="stylesheet" />
  <link type="text/css" href="../../ThirdParty/jQuery/css/fabric/main.css" rel="stylesheet" />

  <script type="text/javascript" src="../../ThirdParty/jQuery/jquery-1.6.2.min.js"></script>
  <script type="text/javascript" src="../../ThirdParty/jQuery/jquery-ui-1.8.16.custom.min.js"></script>
  <script type="text/javascript" src="../../ThirdParty/jQuery/jquery.dataTables.min.js"></script>

  <script type="text/javascript" src="../FABRIC.js" charset="utf-8"></script>
    
  <script type="text/javascript">

$(document).ready(function() {
  
  if(!window.context){
    var contextID = document.location.search.split('?')[1].split('=')[1];
    window.nodeName = document.location.search.split('?')[2].split('=')[1];
    window.context = FABRIC.createContext({ contextID:contextID  });
  }
  var dgnode = context.DG.getAllNamedObjects()[nodeName];
  document.title = 'FABRIC Node Inspector:' + nodeName;
  
  var displayNodeData = function(clear){
    var dataTable = '<table class="display" id="nodeDataTable">\n';
    
    // Define the table header
    var members = dgnode.getMembers();
    dataTable += '<thead>\n<tr>\n';
      dataTable += '<th>slice Id</th>\n';
    for(var memberName in members){
      dataTable += '<th>'+memberName+'</th>\n';
    }
    dataTable += '</tr>\n</thead>\n<tbody class="tableData">\n';
    // Define the body
    var lines = Math.min(dgnode.getCount(), 100);
    for(var i=0; i<lines; i++){
      var slicedata = dgnode.getSliceBulkData(i);
      dataTable += '<tr>\n';
      dataTable += '<td>'+i+'</td>\n';
      for(var memberName in members){
        dataTable += '<td>'+JSON.stringify(slicedata[memberName])+'</td>\n';
      }
      dataTable += '</tr>\n';
    }
    
    dataTable += '</tbody>\n';
    console.log(dataTable);
    
    $('#dataContainer').html( dataTable );
    $('#nodeDataTable').dataTable({
      "bJQueryUI": true,
      "bSort": false,
      "bSearch": false,
    });
  }
  
  displayNodeData();
  
  $('#refresh').button()
      .click(function() {
        displayNodeData(true);
      });
  
});


    </script>



  </head> 
  <body>
    <div id="wrapper">
      <ul id="nav">
        <li><a href="#" id="fabric-logo"><img src="../../themes/default/_img/projects/fabric-logo.png" /></a></li>
      </ul>
      <div id="editor">
        
        <div id="topToolbar">
                 <button id="refresh">Refresh</button>
        </div><!--bottomToolbar-->
        
        <div id="dataContainer">
        </div><!--dataContainer-->
        
      </div> <!--editor-->
    </div><!--wrapper-->
  </body> 
</html>
