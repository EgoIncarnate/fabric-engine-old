<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">  
  <!--
    Copyright 2010-2011 Fabric Technologies Inc. All rights reserved.
    -->
  <title>FABRIC Node Inspector</title>
    
  <link type="text/css" href="../../ThirdParty/jQuery/css/fabric/jquery-ui-1.8.16.custom.css" rel="stylesheet" />
  <link type="text/css" href="../../ThirdParty/jQuery/css/fabric/main.css" rel="stylesheet" />

  <script type="text/javascript" src="../../ThirdParty/jQuery/jquery-1.6.2.min.js"></script>
  <script type="text/javascript" src="../../ThirdParty/jQuery/jquery-ui-1.8.16.custom.min.js"></script>
  <script type="text/javascript" src="../../ThirdParty/jQuery/jquery.dataTables.min.js"></script>

  <script type="text/javascript" src="../FABRIC.js" charset="utf-8"></script>

  <script src="../../ThirdParty/ace/ace.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../ThirdParty/ace/mode-json.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../ThirdParty/ace/theme-textmate.js" type="text/javascript" charset="utf-8"></script>

    
  <script type="text/javascript">

$(document).ready(function() {
  
  if(!window.context){
    var contextID = document.location.search.split('?')[1].split('=')[1];
    window.nodeName = document.location.search.split('?')[2].split('=')[1];
    window.context = FABRIC.createContext({ contextID:contextID  });
  }
  var dgnode = context.DG.getAllNamedObjects()[nodeName];
  document.title = 'FABRIC Node Inspector:' + nodeName;
  
  var displayNodeData = function(clear){
    var dataTable = '<table class="display" id="nodeDataTable">\n';
    
    // Define the table header
    var members = dgnode.getMembers();
    dataTable += '<thead>\n<tr>\n';
      dataTable += '<th>slice Id</th>\n';
    for(var memberName in members){
      dataTable += '<th>'+memberName+'</th>\n';
    }
    dataTable += '</tr>\n</thead>\n<tbody class="tableData">\n';
    // Define the body
    var lines = Math.min(dgnode.getCount(), 100);
    for(var i=0; i<lines; i++){
      var slicedata = dgnode.getSliceBulkData(i);
      dataTable += '<tr>\n';
      dataTable += '<td>'+i+'</td>\n';
      for(var memberName in members){
        dataTable += '<td>'+JSON.stringify(slicedata[memberName])+'</td>\n';
      }
      dataTable += '</tr>\n';
    }
    
    dataTable += '</tbody>\n';
    console.log(dataTable);
    
    $('#dataContainer').html( dataTable );
    $('#nodeDataTable').dataTable({
      "bJQueryUI": true,
      "bSort": false,
      "bSearch": false,
    });
  }
  
  displayNodeData();
  
  $('#refresh').button().click(function() {
        displayNodeData(true);
  });


  var editor = ace.edit("code-editor");
  var jsonMode = require("ace/mode/json").Mode;

  editor.setTheme("ace/theme/textmate");
  editor.getSession().setMode(new jsonMode());


});

</script>

</head> 
<body>
    <div id="wrapper">
      <div id="editor">
        
        <div id="topToolbar">
                 <button id="refresh">Refresh</button>
        </div><!--bottomToolbar-->
        
        <div id="dataContainer">
        </div><!--dataContainer-->
        
      </div> <!--editor-->
    </div><!--wrapper-->

    <div id="code-editor">
{"name":"FlatMaterialShader","programId":9,"shaderSources":[{"code":"\n \r\n\r\n uniform vec4 u_materialColor;\r\n \r\n void main(){\r\n gl_FragColor = u_materialColor;\r\n }\r\n\r\n \n ","type":35632},{"code":"\n \r\n \r\n uniform mat4 u_modelViewProjectionMatrix;\r\n attribute vec4 a_position;\r\n \r\n void main(){\r\n gl_Position = u_modelViewProjectionMatrix * a_position;\r\n }\r\n\r\n \n ","type":35633}],"programParams":[],"uniformValues":[{"name":"u_materialColor","id":6,"location":0},{"name":"u_modelViewProjectionMatrix","id":7,"location":1}],"attributeValues":[{"name":"a_position","id":2,"location":0}],"disableOptions":[],"enableOptions":[],"cullFace":0,"blendModeSfactor":0,"blendModeDfactor":0,"drawMode":-1,"patchVertices":-1,"numInstances":-1,"loadedAttributes":[],"attributesElementCount":0,"debug":false}
    </div>
</body> 
</html>
